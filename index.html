<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d6d6d; -webkit-text-stroke: #6d6d6d}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6b0001; -webkit-text-stroke: #6b0001}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #fb0007; -webkit-text-stroke: #fb0007}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4d5055; -webkit-text-stroke: #4d5055}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000; min-height: 16.0px}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #18702b; -webkit-text-stroke: #18702b}
    span.s1 {font-kerning: none; background-color: #ecf1f7}
    span.s2 {font-kerning: none; color: #fb0007; background-color: #ecf1f7; -webkit-text-stroke: 0px #fb0007}
    span.s3 {font-kerning: none; color: #2a2a2a; background-color: #ecf1f7; -webkit-text-stroke: 0px #2a2a2a}
    span.s4 {font-kerning: none; color: #000000; background-color: #ecf1f7; -webkit-text-stroke: 0px #000000}
    span.s5 {font-kerning: none; color: #0000ff; background-color: #ecf1f7; -webkit-text-stroke: 0px #0000ff}
    span.s6 {font-kerning: none; color: #6b0001; background-color: #ecf1f7; -webkit-text-stroke: 0px #6b0001}
    span.s7 {font-kerning: none; color: #18702b; background-color: #ecf1f7; -webkit-text-stroke: 0px #18702b}
    span.s8 {font-kerning: none; color: #093c94; background-color: #ecf1f7; -webkit-text-stroke: 0px #093c94}
    span.s9 {font-kerning: none; color: #137646; background-color: #ecf1f7; -webkit-text-stroke: 0px #137646}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #4d5055; background-color: #ecf1f7; -webkit-text-stroke: 0px #4d5055}
    span.s12 {font-kerning: none; color: #6f0ec3; background-color: #ecf1f7; -webkit-text-stroke: 0px #6f0ec3}
    span.s13 {font-kerning: none; color: #0e6e6d; background-color: #ecf1f7; -webkit-text-stroke: 0px #0e6e6d}
    span.s14 {font-kerning: none; color: #a4450b; background-color: #ecf1f7; -webkit-text-stroke: 0px #a4450b}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">Protein Folder 3000</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Load Tailwind CSS --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Load Inter font --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"preconnect"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"preconnect"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.gstatic.com"</span><span class="s4"> </span><span class="s2">crossorigin</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s7">'Inter'</span><span class="s1">, </span><span class="s8">sans-serif</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Make canvas responsive and maintain aspect ratio */</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#game-canvas</span><span class="s4"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s9">100%</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s1"> </span><span class="s9">100%</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">object-fit:</span><span class="s1"> </span><span class="s8">contain</span><span class="s1">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">touch-action:</span><span class="s4"> </span><span class="s8">none</span><span class="s4">; </span><span class="s1">/* Disable page scroll while dragging on canvas */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.bead-text</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">700</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s1"> </span><span class="s9">1.25rem</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> </span><span class="s8">rgba(</span><span class="s9">0</span><span class="s1">, </span><span class="s9">0</span><span class="s1">, </span><span class="s9">0</span><span class="s1">, </span><span class="s9">0.7</span><span class="s8">)</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">text-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">1px</span><span class="s1"> </span><span class="s9">1px</span><span class="s1"> </span><span class="s8">rgba(</span><span class="s9">255</span><span class="s1">,</span><span class="s9">255</span><span class="s1">,</span><span class="s9">255</span><span class="s1">,</span><span class="s9">0.3</span><span class="s8">)</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-900 text-gray-100 flex items-center justify-center min-h-screen p-4"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full max-w-5xl mx-auto"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center mb-6"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-4xl font-bold text-white"</span><span class="s3">&gt;</span><span class="s1">Protein Folder 3000</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-lg text-indigo-300"</span><span class="s3">&gt;</span><span class="s1">An AlphaFold-Inspired Puzzle</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">header</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Main Game Area --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-800 shadow-2xl rounded-2xl p-4 sm:p-8"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Instructions --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"instructions"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mb-4 text-center bg-gray-700 p-4 rounded-lg text-gray-200"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- Instructions will be loaded by JavaScript --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Scoreboard --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col sm:flex-row justify-between items-center mb-4 text-center sm:text-left"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-semibold p-2"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Level: </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"level"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-yellow-400"</span><span class="s3">&gt;</span><span class="s1">1</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-semibold p-2"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Target Score: </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"target-score"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-green-400"</span><span class="s3">&gt;</span><span class="s1">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold p-2"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Score: </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"score"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-green-400"</span><span class="s3">&gt;</span><span class="s1">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Permanent Rules Display --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"rules-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mb-4 text-center bg-gray-700 p-4 rounded-lg text-gray-200"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h3</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-bold mb-2 text-white"</span><span class="s3">&gt;</span><span class="s4">Scoring Rules</span><span class="s3">&lt;/</span><span class="s6">h3</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col md:flex-row justify-around text-left"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">&lt;!-- Positive Scores --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"p-2"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h4</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-semibold text-green-400"</span><span class="s3">&gt;</span><span class="s1">Get Points (Physics):</span><span class="s3">&lt;/</span><span class="s6">h4</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">ul</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"list-disc list-inside"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #FACC15;"</span><span class="s3">&gt;</span><span class="s4">H</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> near </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #FACC15;"</span><span class="s3">&gt;</span><span class="s4">H</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> (+15)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #F87171;"</span><span class="s3">&gt;</span><span class="s4">+</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> near </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #4ADE80;"</span><span class="s3">&gt;</span><span class="s4">-</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> (+30)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold"</span><span class="s1"> </span><span class="s2">style</span><span class="s3">=</span><span class="s5">"color: #60A5FA;"</span><span class="s3">&gt;</span><span class="s1">P</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s1"> on Edge (+8)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #D97706;"</span><span class="s3">&gt;</span><span class="s4">C</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> near </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #FACC15;"</span><span class="s3">&gt;</span><span class="s4">H</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> (+10)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">ul</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">&lt;!-- AI Hints --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"p-2"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h4</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-semibold text-indigo-300"</span><span class="s3">&gt;</span><span class="s1">Get Points (AI Hints):</span><span class="s3">&lt;/</span><span class="s6">h4</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">ul</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"list-disc list-inside"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;</span><span class="s1">Bead in </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold text-yellow-300"</span><span class="s3">&gt;</span><span class="s1">Core Zone</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s1"> (+5)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;</span><span class="s1">Satisfy </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold text-pink-400"</span><span class="s3">&gt;</span><span class="s1">Pair Hint</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s1"> (+25)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">ul</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">&lt;!-- Negative Scores --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"p-2"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">h4</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-semibold text-red-400"</span><span class="s3">&gt;</span><span class="s1">Lose Points (Physics):</span><span class="s3">&lt;/</span><span class="s6">h4</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">ul</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"list-disc list-inside"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #F87171;"</span><span class="s3">&gt;</span><span class="s4">+</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> near </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #F87171;"</span><span class="s3">&gt;</span><span class="s4">+</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> (-20)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #4ADE80;"</span><span class="s3">&gt;</span><span class="s4">-</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> near </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #4ADE80;"</span><span class="s3">&gt;</span><span class="s4">-</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> (-20)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold"</span><span class="s1"> </span><span class="s2">style</span><span class="s3">=</span><span class="s5">"color: #FACC15;"</span><span class="s3">&gt;</span><span class="s1">H</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s1"> on Edge (-10)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #FACC15;"</span><span class="s3">&gt;</span><span class="s4">H</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> near </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"color: #60A5FA;"</span><span class="s3">&gt;</span><span class="s4">P</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> (-5)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">li</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"font-bold"</span><span class="s1"> </span><span class="s2">style</span><span class="s3">=</span><span class="s5">"color: #D97706;"</span><span class="s3">&gt;</span><span class="s1">C</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s1"> on Edge (-25)</span><span class="s3">&lt;/</span><span class="s6">li</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">ul</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Game Board --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"grid-container"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"relative w-full max-w-lg mx-auto aspect-square bg-gray-900 rounded-lg border-4 border-blue-500 overflow-hidden shadow-inner"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- The "water" edge --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">canvas</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"game-canvas"</span><span class="s3">&gt;&lt;/</span><span class="s6">canvas</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Controls --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-6 text-center flex flex-wrap justify-center gap-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"undo-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Undo</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"reset-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-red-600 hover:bg-red-500 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Reset</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"hint-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Get Hint</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"toggle-hints-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Toggle Hints</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-score-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Explain Score</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"solution-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Show Solution</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Win Modal --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"win-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-800 p-8 rounded-2xl shadow-2xl text-center max-w-md w-full border-2 border-green-500"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"modal-title"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold text-green-400 mb-4"</span><span class="s3">&gt;</span><span class="s4">You did it!</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"modal-message"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-lg text-gray-200 mb-8"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- Modal message will be loaded by JavaScript --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"modal-next-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-8 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>Next Level</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"modal-close-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-8 rounded-lg text-lg shadow-md transition duration-200 ml-4"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>Play Again</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Hint Modal --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"hint-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-800 p-8 rounded-2xl shadow-2xl text-center max-w-md w-full border-2 border-yellow-500"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold text-yellow-400 mb-4"</span><span class="s3">&gt;</span><span class="s4">Hint!</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"hint-message"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-lg text-gray-200 mb-8"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- Hint message will be loaded by JavaScript --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"hint-close-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-3 px-8 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>Got it!</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Explain Score Modal --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-800 p-8 rounded-2xl shadow-2xl text-center max-w-md w-full border-2 border-cyan-500"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold text-cyan-400 mb-6"</span><span class="s3">&gt;</span><span class="s4">Score Breakdown</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-lg text-gray-200 mb-8 text-left space-y-2"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between"</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4">Physics (Edges):</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-edge"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between"</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4">Physics (Attraction):</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-attraction"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold text-green-400"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between"</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4">Physics (Repulsion):</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-repulsion"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold text-red-400"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">hr</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"border-gray-600 my-2"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between"</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4">AI Hint (Core Zone):</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-ai-zone"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold text-indigo-300"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between"</span><span class="s3">&gt;&lt;</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4">AI Hint (Pair Bonus):</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-ai-pair"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold text-indigo-300"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">hr</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"border-gray-500 my-3"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between text-2xl"</span><span class="s3">&gt;&lt;</span><span class="s6">strong</span><span class="s3">&gt;</span><span class="s4">Total Score:</span><span class="s3">&lt;/</span><span class="s6">strong</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s6">strong</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-total"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-white"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">strong</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"explain-close-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-3 px-8 rounded-lg text-lg shadow-md transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>Got it!</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Game Constants ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> </span><span class="s13">GRID_SIZE</span><span class="s1"> = </span><span class="s14">12</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> </span><span class="s13">BEAD_TYPES</span><span class="s1"> = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'A'</span><span class="s1">: { color: </span><span class="s7">'#9CA3AF'</span><span class="s1">, name: </span><span class="s7">'Anchor'</span><span class="s1"> }, </span><span class="s11">// Gray-400</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'H'</span><span class="s1">: { color: </span><span class="s7">'#FACC15'</span><span class="s1">, name: </span><span class="s7">'Hydrophobic'</span><span class="s1"> }, </span><span class="s11">// Yellow-400</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'P'</span><span class="s1">: { color: </span><span class="s7">'#60A5FA'</span><span class="s1">, name: </span><span class="s7">'Polar'</span><span class="s1"> }, </span><span class="s11">// Blue-400</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'+'</span><span class="s1">: { color: </span><span class="s7">'#F87171'</span><span class="s1">, name: </span><span class="s7">'Positive'</span><span class="s1"> }, </span><span class="s11">// Red-400</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'-'</span><span class="s1">: { color: </span><span class="s7">'#4ADE80'</span><span class="s1">, name: </span><span class="s7">'Negative'</span><span class="s1"> },<span class="Apple-converted-space">  </span></span><span class="s11">// Green-400</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'C'</span><span class="s1">: { color: </span><span class="s7">'#D97706'</span><span class="s1">, name: </span><span class="s7">'Core'</span><span class="s1"> } </span><span class="s11">// Amber-600</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Scoring Constants ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> </span><span class="s13">SCORE_PHYSICS</span><span class="s1"> = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">EDGE_H</span><span class="s1">: -</span><span class="s14">10</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">EDGE_P</span><span class="s1">: </span><span class="s14">8</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">EDGE_C</span><span class="s1">: -</span><span class="s14">25</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">ATTRACT_H_H</span><span class="s1">: </span><span class="s14">15</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">ATTRACT_POS_NEG</span><span class="s1">: </span><span class="s14">30</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">ATTRACT_C_H</span><span class="s1">: </span><span class="s14">10</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">REPEL_POS_POS</span><span class="s1">: -</span><span class="s14">20</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">REPEL_NEG_NEG</span><span class="s1">: -</span><span class="s14">20</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">REPEL_H_P</span><span class="s1">: -</span><span class="s14">5</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> </span><span class="s13">SCORE_AI</span><span class="s1"> = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">ZONE_BONUS</span><span class="s1">: </span><span class="s14">5</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">PAIR_BONUS</span><span class="s1">: </span><span class="s14">25</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Game State ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> canvas, ctx;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> cellSize;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> proteinChain = [];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> previousState = []; </span><span class="s11">// For undo</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> constraints = [];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> currentLevel = </span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> targetScore = </span><span class="s14">0</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> score = </span><span class="s14">0</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> scoreBreakdown = {};</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> showHints = </span><span class="s12">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> isDragging = </span><span class="s12">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> draggedBeadIndex = -</span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> lastValidChain = []; </span><span class="s11">// For chain physics</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- DOM Elements ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> scoreEl = document.getElementById(</span><span class="s7">'score'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> levelEl = document.getElementById(</span><span class="s7">'level'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> targetScoreEl = document.getElementById(</span><span class="s7">'target-score'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> instructionsEl = document.getElementById(</span><span class="s7">'instructions'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> gridContainer = document.getElementById(</span><span class="s7">'grid-container'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> resetButton = document.getElementById(</span><span class="s7">'reset-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> winModal = document.getElementById(</span><span class="s7">'win-modal'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> modalTitle = document.getElementById(</span><span class="s7">'modal-title'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> modalMessage = document.getElementById(</span><span class="s7">'modal-message'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> modalNextButton = document.getElementById(</span><span class="s7">'modal-next-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> modalCloseButton = document.getElementById(</span><span class="s7">'modal-close-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> hintModal = document.getElementById(</span><span class="s7">'hint-modal'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> hintMessage = document.getElementById(</span><span class="s7">'hint-message'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> hintCloseButton = document.getElementById(</span><span class="s7">'hint-close-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> hintButton = document.getElementById(</span><span class="s7">'hint-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> solutionButton = document.getElementById(</span><span class="s7">'solution-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> undoButton = document.getElementById(</span><span class="s7">'undo-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> toggleHintsButton = document.getElementById(</span><span class="s7">'toggle-hints-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> explainScoreButton = document.getElementById(</span><span class="s7">'explain-score-button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> explainModal = document.getElementById(</span><span class="s7">'explain-modal'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> explainCloseButton = document.getElementById(</span><span class="s7">'explain-close-button'</span><span class="s1">);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Game Levels Configuration ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> levels = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">1</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">25</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 1: The Folding Challenge!&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Drag the beads to fold the protein. &lt;strong&gt;Movement Rule:&lt;/strong&gt; You can only drag a bead to an empty, adjacent (up, down, left, right) square. The chain cannot break!</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Try to match the &lt;strong&gt;Target Score&lt;/strong&gt; using the rules below.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;It's hard, right? This is the "impossible search"!&lt;/strong&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">2</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">50</span><span class="s1">, </span><span class="s11">// Will be auto-adjusted</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 2: The AlphaFold Way!&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Same puzzle, but now you have &lt;strong&gt;constraints&lt;/strong&gt;, just like AlphaFold uses. These hints now give you BONUS points!</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;ul class="list-disc list-inside text-left w-fit mx-auto my-2"&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;li&gt;The &lt;span class="font-bold text-yellow-300"&gt;yellow zone&lt;/span&gt; is a "hydrophobic core". 'H' &amp; 'C' beads get points here!&lt;/li&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;li&gt;The &lt;span class="font-bold text-pink-400"&gt;glowing line&lt;/span&gt; shows two beads that must be close.&lt;/li&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/ul&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Follow the hints. Notice how much easier it is?</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 1: Hydrophobic core</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'zone'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1">, w: </span><span class="s14">4</span><span class="s1">, h: </span><span class="s14">4</span><span class="s1">, color: </span><span class="s7">'rgba(250, 204, 21, 0.3)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 2: Pair constraint (indices 1 and 2 are 'H' and 'H') - This is the fix</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">1</span><span class="s1">, i2: </span><span class="s14">2</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> }<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">3</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">45</span><span class="s1">, </span><span class="s11">// Was 75</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 3: Getting Harder...&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>This protein chain is longer. The rules are the same, but the number of possible folds is much larger.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Try to find the high-scoring fold. Notice how much time you spend just guessing?</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">4</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">120</span><span class="s1">, </span><span class="s11">// Will be auto-adjusted</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 4: Constraints to the Rescue!&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>This is the *exact same* puzzle as Level 3, but with AI-powered hints that give bonus points!</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Use the hints to solve this complex fold and watch your score climb.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 1: Hydrophobic core</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'zone'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1">, w: </span><span class="s14">5</span><span class="s1">, h: </span><span class="s14">5</span><span class="s1">, color: </span><span class="s7">'rgba(250, 204, 21, 0.3)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 2: Pair constraint (indices 4 and 6 are '+' and '-')</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">4</span><span class="s1">, i2: </span><span class="s14">6</span><span class="s1">, color: </span><span class="s7">'rgba(236, 72, 153, 0.8)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 3: Pair constraint (indices 9 and 10 are '+' and '-')</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">9</span><span class="s1">, i2: </span><span class="s14">10</span><span class="s1">, color: </span><span class="s7">'rgba(236, 72, 153, 0.8)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 4: Pair constraint (indices 1 and 8 are 'H' and 'H')</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">1</span><span class="s1">, i2: </span><span class="s14">8</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> }<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">5</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">15</span><span class="s1">, </span><span class="s11">// Was 65</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 5: The "Impossible" Problem&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>This chain is even longer. The number of possible folds is astronomical.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Finding the optimal fold by hand is practically impossible. &lt;strong&gt;This is the real challenge of protein folding.&lt;/strong&gt; AI like AlphaFold is needed to find patterns in this chaos.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">8</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">6</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">15</span><span class="s1">, </span><span class="s11">// Was 40</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 6: New Rule - Core Beads!&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>This puzzle introduces a new bead: &lt;span class="font-bold" style="color: #D97706;"&gt;'C' (Core)&lt;/span&gt;.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>'C' beads are like 'H' beads but &lt;span class="font-bold text-red-400"&gt;hate&lt;/span&gt; the edge even more! They also like being near 'H' beads.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">7</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">115</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 7: The Final Challenge&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>This is it. A long, complex chain with all the rules combined.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>The number of possible folds is truly massive. Finding the optimal fold by hand is nearly impossible. Give it a try, but don't worry... AlphaFold is coming.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">8</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">115</span><span class="s1">, </span><span class="s11">// Will be auto-adjusted</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 8: The AlphaFold Solution&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>This is the *exact same* puzzle from Level 7. But now, you have the AI-powered constraints and bonuses.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Use the zones and glowing lines to solve this "impossible" puzzle with ease. This is the power of AlphaFold!</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 1: Large Hydrophobic/Core zone</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'zone'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1">, w: </span><span class="s14">6</span><span class="s1">, h: </span><span class="s14">6</span><span class="s1">, color: </span><span class="s7">'rgba(250, 204, 21, 0.3)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 2: Pair constraint (+/-)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">2</span><span class="s1">, i2: </span><span class="s14">6</span><span class="s1">, color: </span><span class="s7">'rgba(236, 72, 153, 0.8)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 3: Pair constraint (+/-)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">10</span><span class="s1">, i2: </span><span class="s14">14</span><span class="s1">, color: </span><span class="s7">'rgba(236, 72, 153, 0.8)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 4: Pair constraint (C/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">4</span><span class="s1">, i2: </span><span class="s14">5</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 5: Pair constraint (C/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">8</span><span class="s1">, i2: </span><span class="s14">9</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 6: Pair constraint (C/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">12</span><span class="s1">, i2: </span><span class="s14">13</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">8</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">9</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">280</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 9: The Real "Impossible" Problem&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>This is it. A 25-bead protein on a 12x12 grid. The number of possible folds is in the quadrillions.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Finding the optimal score (280) by hand is not a matter of skill, but of pure luck. It would take an incredible amount of time. &lt;strong&gt;This is the real search problem.&lt;/strong&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Feel free to try, or click "Show Solution" to see what you're up against.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">1</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">2</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">8</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">9</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">9</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">8</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">2</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">1</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">1</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s14">10</span><span class="s1">: {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore: </span><span class="s14">280</span><span class="s1">, </span><span class="s11">// Will be auto-adjusted</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>instructions: </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;strong&gt;Level 10: The AI-Powered Solution&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>Same "impossible" puzzle from Level 9. But now, you have the AI's analysis and score bonuses.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                    </span>The hints look complex, but they are your map. Follow the huge "core" zone and the many pair lines, and the impossible becomes possible.</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>chain: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">1</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">2</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">8</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">9</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">10</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">9</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">8</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">2</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">1</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">1</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>constraints: [</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 1: Large Hydrophobic/Core zone</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'zone'</span><span class="s1">, x: </span><span class="s14">1</span><span class="s1">, y: </span><span class="s14">2</span><span class="s1">, w: </span><span class="s14">8</span><span class="s1">, h: </span><span class="s14">7</span><span class="s1">, color: </span><span class="s7">'rgba(250, 204, 21, 0.3)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 2: Pair constraint (+/-)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">2</span><span class="s1">, i2: </span><span class="s14">6</span><span class="s1">, color: </span><span class="s7">'rgba(236, 72, 153, 0.8)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 3: Pair constraint (+/-)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">10</span><span class="s1">, i2: </span><span class="s14">14</span><span class="s1">, color: </span><span class="s7">'rgba(236, 72, 153, 0.8)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 4: Pair constraint (+/-)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">19</span><span class="s1">, i2: </span><span class="s14">22</span><span class="s1">, color: </span><span class="s7">'rgba(236, 72, 153, 0.8)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 5: Pair constraint (H/C)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">3</span><span class="s1">, i2: </span><span class="s14">13</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 6: Pair constraint (H/C)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">5</span><span class="s1">, i2: </span><span class="s14">8</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 7: Pair constraint (C/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">8</span><span class="s1">, i2: </span><span class="s14">11</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 8: Pair constraint (H/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">9</span><span class="s1">, i2: </span><span class="s14">11</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 9: Pair constraint (C/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">12</span><span class="s1">, i2: </span><span class="s14">16</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 10: Pair constraint (C/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">17</span><span class="s1">, i2: </span><span class="s14">18</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 11: Pair constraint (C/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">20</span><span class="s1">, i2: </span><span class="s14">21</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> },</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Hint 12: Pair constraint (H/H)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'pair'</span><span class="s1">, i1: </span><span class="s14">18</span><span class="s1">, i2: </span><span class="s14">24</span><span class="s1">, color: </span><span class="s7">'rgba(202, 138, 4, 0.7)'</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>solution: [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>{ type: </span><span class="s7">'A'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">2</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">3</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">4</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">3</span><span class="s1"> }, { type: </span><span class="s7">'+'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">4</span><span class="s1"> }, { type: </span><span class="s7">'C'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">5</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">6</span><span class="s1"> }, { type: </span><span class="s7">'-'</span><span class="s1">, x: </span><span class="s14">7</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'P'</span><span class="s1">, x: </span><span class="s14">6</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }, { type: </span><span class="s7">'H'</span><span class="s1">, x: </span><span class="s14">5</span><span class="s1">, y: </span><span class="s14">7</span><span class="s1"> }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Game Logic ---</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Helper function for Manhattan distance</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> manhattanDistance(beadA, beadB) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> </span><span class="s13">Math</span><span class="s1">.abs(beadA.x - beadB.x) + </span><span class="s13">Math</span><span class="s1">.abs(beadA.y - beadB.y);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> setupLevel(levelNum) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>currentLevel = levelNum;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> levelData = levels[levelNum];</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>levelEl.textContent = levelNum;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>instructionsEl.innerHTML = levelData.instructions;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Deep copy of the chain</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>proteinChain = levelData.chain.map(bead =&gt; ({ ...bead }));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>lastValidChain = proteinChain.map(bead =&gt; ({ ...bead })); </span><span class="s11">// For chain physics</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>previousState = proteinChain.map(bead =&gt; ({ ...bead })); </span><span class="s11">// For undo</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>constraints = levelData.constraints;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Auto-calibrate target score</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (levelData.solution) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> solutionScore = calculateScoreFromChain(levelData.solution, constraints).total;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Set target to 80% of solution, but not less than the original target</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore = </span><span class="s13">Math</span><span class="s1">.max(levelData.targetScore, </span><span class="s13">Math</span><span class="s1">.floor(solutionScore * </span><span class="s14">0.8</span><span class="s1">));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s12">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>targetScore = levelData.targetScore;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>targetScoreEl.textContent = targetScore;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>winModal.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Check if there is a next level</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (levels[levelNum + </span><span class="s14">1</span><span class="s1">]) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>modalNextButton.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>modalCloseButton.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s12">else</span><span class="s1"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// This is the last level</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>modalNextButton.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>modalCloseButton.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>calculateScore(); </span><span class="s11">// This will call drawGame()</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* New master scoring function.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Calculates score from a given chain state.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Returns a full breakdown object.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> calculateScoreFromChain(chain, currentConstraints) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> breakdown = { edge: </span><span class="s14">0</span><span class="s1">, attraction: </span><span class="s14">0</span><span class="s1">, repulsion: </span><span class="s14">0</span><span class="s1">, aiZone: </span><span class="s14">0</span><span class="s1">, aiPair: </span><span class="s14">0</span><span class="s1"> };</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> checkedPairs = </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Set</span><span class="s1">();</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 1. Per-bead scores (Edge, AI Zone)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> i = </span><span class="s14">0</span><span class="s1">; i &lt; chain.length; i++) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> beadA = chain[i];</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">// Check edge</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> onEdge = beadA.x === </span><span class="s14">0</span><span class="s1"> || beadA.x === </span><span class="s13">GRID_SIZE</span><span class="s1"> - </span><span class="s14">1</span><span class="s1"> || beadA.y === </span><span class="s14">0</span><span class="s1"> || beadA.y === </span><span class="s13">GRID_SIZE</span><span class="s1"> - </span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (onEdge) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (beadA.type === </span><span class="s7">'H'</span><span class="s1">) breakdown.edge += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">EDGE_H</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (beadA.type === </span><span class="s7">'P'</span><span class="s1">) breakdown.edge += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">EDGE_P</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (beadA.type === </span><span class="s7">'C'</span><span class="s1">) breakdown.edge += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">EDGE_C</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">// Check AI Zone</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">const</span><span class="s1"> constraint </span><span class="s12">of</span><span class="s1"> currentConstraints) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (constraint.type === </span><span class="s7">'zone'</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">const</span><span class="s1"> inZone = beadA.x &gt;= constraint.x &amp;&amp; beadA.x &lt; (constraint.x + constraint.w) &amp;&amp;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                     </span>beadA.y &gt;= constraint.y &amp;&amp; beadA.y &lt; (constraint.y + constraint.h);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">if</span><span class="s1"> (inZone &amp;&amp; (beadA.type === </span><span class="s7">'H'</span><span class="s1"> || beadA.type === </span><span class="s7">'C'</span><span class="s1">)) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>breakdown.aiZone += </span><span class="s13">SCORE_AI</span><span class="s1">.</span><span class="s13">ZONE_BONUS</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// 2. Pairwise scores (Physics)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> j = i + </span><span class="s14">1</span><span class="s1">; j &lt; chain.length; j++) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> beadB = chain[j];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> isAdjacent = manhattanDistance(beadA, beadB) === </span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (isAdjacent) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">const</span><span class="s1"> typeA = beadA.type;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">const</span><span class="s1"> typeB = beadB.type;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">// Attraction</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'H'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'H'</span><span class="s1">)) breakdown.attraction += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">ATTRACT_H_H</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'+'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'-'</span><span class="s1">) || (typeA === </span><span class="s7">'-'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'+'</span><span class="s1">)) breakdown.attraction += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">ATTRACT_POS_NEG</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'C'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'H'</span><span class="s1">) || (typeA === </span><span class="s7">'H'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'C'</span><span class="s1">)) breakdown.attraction += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">ATTRACT_C_H</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">// Repulsion</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'+'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'+'</span><span class="s1">)) breakdown.repulsion += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">REPEL_POS_POS</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'-'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'-'</span><span class="s1">)) breakdown.repulsion += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">REPEL_NEG_NEG</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'H'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'P'</span><span class="s1">) || (typeA === </span><span class="s7">'P'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'H'</span><span class="s1">)) breakdown.repulsion += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">REPEL_H_P</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 3. AI Pair scores</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">const</span><span class="s1"> constraint </span><span class="s12">of</span><span class="s1"> currentConstraints) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (constraint.type === </span><span class="s7">'pair'</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> bead1 = chain[constraint.i1];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> bead2 = chain[constraint.i2];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (manhattanDistance(bead1, bead2) === </span><span class="s14">1</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>breakdown.aiPair += </span><span class="s13">SCORE_AI</span><span class="s1">.</span><span class="s13">PAIR_BONUS</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>breakdown.total = breakdown.edge + breakdown.attraction + breakdown.repulsion + breakdown.aiZone + breakdown.aiPair;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> breakdown;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Calculates the score for the *current* game state</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* and updates all UI elements.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> calculateScore() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> breakdown = calculateScoreFromChain(proteinChain, constraints);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>score = breakdown.total;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>scoreBreakdown = breakdown; </span><span class="s11">// Save for explain modal</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>scoreEl.textContent = score;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Redraw (to update pLDDT rings) and check for win</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>drawGame();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>checkWinCondition();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* New function to calculate the local score for a single bead.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* Used for the pLDDT "confidence" ring.</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> calculateBeadScore(chain, index) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> localScore = </span><span class="s14">0</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> beadA = chain[index];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (!beadA) </span><span class="s12">return</span><span class="s1"> </span><span class="s14">0</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 1. Edge score</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> onEdge = beadA.x === </span><span class="s14">0</span><span class="s1"> || beadA.x === </span><span class="s13">GRID_SIZE</span><span class="s1"> - </span><span class="s14">1</span><span class="s1"> || beadA.y === </span><span class="s14">0</span><span class="s1"> || beadA.y === </span><span class="s13">GRID_SIZE</span><span class="s1"> - </span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (onEdge) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (beadA.type === </span><span class="s7">'H'</span><span class="s1">) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">EDGE_H</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (beadA.type === </span><span class="s7">'P'</span><span class="s1">) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">EDGE_P</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (beadA.type === </span><span class="s7">'C'</span><span class="s1">) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">EDGE_C</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 2. AI Zone score</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">const</span><span class="s1"> constraint </span><span class="s12">of</span><span class="s1"> constraints) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (constraint.type === </span><span class="s7">'zone'</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> inZone = beadA.x &gt;= constraint.x &amp;&amp; beadA.x &lt; (constraint.x + constraint.w) &amp;&amp;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span>beadA.y &gt;= constraint.y &amp;&amp; beadA.y &lt; (constraint.y + constraint.h);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (inZone &amp;&amp; (beadA.type === </span><span class="s7">'H'</span><span class="s1"> || beadA.type === </span><span class="s7">'C'</span><span class="s1">)) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>localScore += </span><span class="s13">SCORE_AI</span><span class="s1">.</span><span class="s13">ZONE_BONUS</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 3. Physics neighbor scores</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> j = </span><span class="s14">0</span><span class="s1">; j &lt; chain.length; j++) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (index === j) </span><span class="s12">continue</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> beadB = chain[j];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (manhattanDistance(beadA, beadB) === </span><span class="s14">1</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> typeA = beadA.type;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> typeB = beadB.type;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'H'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'H'</span><span class="s1">)) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">ATTRACT_H_H</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'+'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'-'</span><span class="s1">) || (typeA === </span><span class="s7">'-'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'+'</span><span class="s1">)) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">ATTRACT_POS_NEG</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'C'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'H'</span><span class="s1">) || (typeA === </span><span class="s7">'H'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'C'</span><span class="s1">)) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">ATTRACT_C_H</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'+'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'+'</span><span class="s1">)) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">REPEL_POS_POS</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'-'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'-'</span><span class="s1">)) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">REPEL_NEG_NEG</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> ((typeA === </span><span class="s7">'H'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'P'</span><span class="s1">) || (typeA === </span><span class="s7">'P'</span><span class="s1"> &amp;&amp; typeB === </span><span class="s7">'H'</span><span class="s1">)) localScore += </span><span class="s13">SCORE_PHYSICS</span><span class="s1">.</span><span class="s13">REPEL_H_P</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 4. AI Pair scores</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">const</span><span class="s1"> constraint </span><span class="s12">of</span><span class="s1"> constraints) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (constraint.type === </span><span class="s7">'pair'</span><span class="s1"> &amp;&amp; (constraint.i1 === index || constraint.i2 === index)) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> bead1 = chain[constraint.i1];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> bead2 = chain[constraint.i2];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (manhattanDistance(bead1, bead2) === </span><span class="s14">1</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>localScore += </span><span class="s13">SCORE_AI</span><span class="s1">.</span><span class="s13">PAIR_BONUS</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> localScore;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Returns a color based on the local bead score</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> getpLDDTColor(score) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (score &lt; </span><span class="s14">0</span><span class="s1">) </span><span class="s12">return</span><span class="s1"> </span><span class="s7">'#F87171'</span><span class="s1">; </span><span class="s11">// Red-400</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (score &lt; </span><span class="s14">15</span><span class="s1">) </span><span class="s12">return</span><span class="s1"> </span><span class="s7">'#FACC15'</span><span class="s1">; </span><span class="s11">// Yellow-400</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> </span><span class="s7">'#4ADE80'</span><span class="s1">; </span><span class="s11">// Green-400</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> checkWinCondition() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (score &gt;= targetScore) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (currentLevel === </span><span class="s14">1</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>modalTitle.textContent = </span><span class="s7">'Great Fold!'</span><span class="s1">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>modalMessage.textContent = </span><span class="s1">'You hit the target score! That was tough, wasn\'t it? Now let\'s see how AlphaFold makes this easier.'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> (currentLevel === </span><span class="s14">3</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>modalMessage.textContent = </span><span class="s7">'Whew! That was tough!'</span><span class="s1">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>modalMessage.textContent = </span><span class="s1">'You did it, but notice how much harder that was? Now let\'s try that again, but with some AI hints.'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> (currentLevel === </span><span class="s14">5</span><span class="s1"> || currentLevel === </span><span class="s14">7</span><span class="s1"> || currentLevel === </span><span class="s14">9</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>modalTitle.textContent = </span><span class="s7">'Incredible!'</span><span class="s1">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>modalMessage.textContent = </span><span class="s1">'You actually found the optimal fold! That is seriously impressive. You must have a bright future in biochemistry!'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s12">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>modalTitle.textContent = </span><span class="s7">'Puzzle Solved!'</span><span class="s1">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>modalMessage.textContent = </span><span class="s1">'Amazing! By following the AI hints, you solved the complex puzzle and got the bonus points! This is exactly how AlphaFold works.'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (currentLevel === </span><span class="s14">10</span><span class="s1">) { </span><span class="s11">// Check if it's the new last level</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>modalTitle.textContent = </span><span class="s7">'Congratulations!'</span><span class="s1">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>modalMessage.textContent = </span><span class="s1">'You\'ve completed all the challenges and demonstrated the power of AlphaFold! You turned an impossible problem into a solvable puzzle.'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>winModal.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Hint Logic ---</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> getHint() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> worstBead = </span><span class="s12">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> lowestScore = </span><span class="s13">Infinity</span><span class="s1">; </span><span class="s11">// Start high, find lowest</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> i = </span><span class="s14">1</span><span class="s1">; i &lt; proteinChain.length; i++) { </span><span class="s11">// Start from 1 (skip anchor)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> currentBeadScore = calculateBeadScore(proteinChain, i);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (currentBeadScore &lt; lowestScore) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>lowestScore = currentBeadScore;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>worstBead = proteinChain[i];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Only return a bead if its score is actually negative</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (lowestScore &lt; </span><span class="s14">0</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s12">return</span><span class="s1"> worstBead;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s4"> </span><span class="s12">null</span><span class="s4">; </span><span class="s1">// All beads are in good (or neutral) spots!</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> showHint() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (showHints &amp;&amp; (currentLevel === </span><span class="s14">2</span><span class="s1"> || currentLevel === </span><span class="s14">4</span><span class="s1"> || currentLevel === </span><span class="s14">8</span><span class="s1"> || currentLevel === </span><span class="s14">10</span><span class="s1">)) {</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span>hintMessage.innerHTML = </span><span class="s1">'The best hints are already on the screen! &lt;br&gt;&lt;br&gt;Use the &lt;span class="font-bold text-yellow-300"&gt;yellow zones&lt;/span&gt; and &lt;span class="font-bold text-pink-400"&gt;glowing lines&lt;/span&gt; to guide your fold.'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s12">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> worstBead = getHint();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (worstBead) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> beadInfo = </span><span class="s13">BEAD_TYPES</span><span class="s1">[worstBead.type];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>hintMessage.innerHTML = </span><span class="s7">`This &lt;span class="font-bold" style="color: </span><span class="s1">${beadInfo.color}</span><span class="s7">;"&gt;</span><span class="s1">${beadInfo.name}</span><span class="s7"> ('</span><span class="s1">${worstBead.type}</span><span class="s7">')&lt;/span&gt; bead at grid position (</span><span class="s1">${worstBead.x}</span><span class="s7">, </span><span class="s1">${worstBead.y}</span><span class="s7">) is in a bad spot! (Local Score: </span><span class="s1">${</span><span class="s13">Math</span><span class="s1">.floor(calculateBeadScore(proteinChain, proteinChain.indexOf(worstBead)))}</span><span class="s7">) &lt;br&gt;&lt;br&gt;Try moving it to improve your score.`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s12">else</span><span class="s1"> {</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>hintMessage.textContent = </span><span class="s1">'You\'re doing great! No obvious bad moves found. Keep experimenting!'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>hintModal.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> showSolution() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> levelData = levels[currentLevel];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (!levelData.solution) </span><span class="s12">return</span><span class="s1">; </span><span class="s11">// No solution stored</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Save current state for undo</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>previousState = proteinChain.map(bead =&gt; ({ ...bead }));</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Deep copy the solution into the main chain</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>proteinChain = levelData.solution.map(bead =&gt; ({ ...bead }));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>lastValidChain = proteinChain.map(bead =&gt; ({ ...bead })); </span><span class="s11">// Update valid chain</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Recalculate score (which should be high)</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span>calculateScore(); </span><span class="s1">// This calls drawGame() and checkWinCondition()</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> undoMove() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>proteinChain = previousState.map(bead =&gt; ({ ...bead }));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>lastValidChain = proteinChain.map(bead =&gt; ({ ...bead })); </span><span class="s11">// Revert valid chain</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>calculateScore(); </span><span class="s11">// This calls drawGame()</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> toggleHints() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>showHints = !showHints;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>toggleHintsButton.textContent = showHints ? </span><span class="s7">"Hide Hints"</span><span class="s1"> : </span><span class="s7">"Show Hints"</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>toggleHintsButton.classList.toggle(</span><span class="s7">'bg-indigo-600'</span><span class="s1">, showHints);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>toggleHintsButton.classList.toggle(</span><span class="s7">'hover:bg-indigo-500'</span><span class="s1">, showHints);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>toggleHintsButton.classList.toggle(</span><span class="s7">'bg-gray-600'</span><span class="s1">, !showHints);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>toggleHintsButton.classList.toggle(</span><span class="s7">'hover:bg-gray-500'</span><span class="s1">, !showHints);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>drawGame();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> showExplainScore() {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Populate modal</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-edge'</span><span class="s1">).textContent = scoreBreakdown.edge;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-attraction'</span><span class="s1">).textContent = scoreBreakdown.attraction;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-repulsion'</span><span class="s1">).textContent = scoreBreakdown.repulsion;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-ai-zone'</span><span class="s1">).textContent = scoreBreakdown.aiZone;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-ai-pair'</span><span class="s1">).textContent = scoreBreakdown.aiPair;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-total'</span><span class="s1">).textContent = scoreBreakdown.total;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Update colors</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-attraction'</span><span class="s1">).className = scoreBreakdown.attraction &gt; </span><span class="s14">0</span><span class="s1"> ? </span><span class="s7">'font-bold text-green-400'</span><span class="s1"> : </span><span class="s7">'font-bold'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-repulsion'</span><span class="s1">).className = scoreBreakdown.repulsion &lt; </span><span class="s14">0</span><span class="s1"> ? </span><span class="s7">'font-bold text-red-400'</span><span class="s1"> : </span><span class="s7">'font-bold'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-ai-zone'</span><span class="s1">).className = scoreBreakdown.aiZone &gt; </span><span class="s14">0</span><span class="s1"> ? </span><span class="s7">'font-bold text-indigo-300'</span><span class="s1"> : </span><span class="s7">'font-bold'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-ai-pair'</span><span class="s1">).className = scoreBreakdown.aiPair &gt; </span><span class="s14">0</span><span class="s1"> ? </span><span class="s7">'font-bold text-indigo-300'</span><span class="s1"> : </span><span class="s7">'font-bold'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'explain-total'</span><span class="s1">).className = scoreBreakdown.total &gt; </span><span class="s14">0</span><span class="s1"> ? </span><span class="s7">'font-bold text-green-400'</span><span class="s1"> : (scoreBreakdown.total &lt; </span><span class="s14">0</span><span class="s1"> ? </span><span class="s7">'font-bold text-red-400'</span><span class="s1"> : </span><span class="s7">'font-bold text-white'</span><span class="s1">);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>explainModal.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Drawing Logic ---</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> drawGame() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (!ctx) </span><span class="s12">return</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> dpr = window.devicePixelRatio || </span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> rect = gridContainer.getBoundingClientRect();</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Set internal canvas size</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> internalWidth = rect.width;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> internalHeight = rect.height;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Set display canvas size</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.width = internalWidth * dpr;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.height = internalHeight * dpr;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Scale context for high-DPI</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.scale(dpr, dpr);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>cellSize = internalWidth / </span><span class="s13">GRID_SIZE</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Clear canvas</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.fillStyle = </span><span class="s7">'#1F2937'</span><span class="s1">; </span><span class="s11">// gray-800</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.fillRect(</span><span class="s14">0</span><span class="s1">, </span><span class="s14">0</span><span class="s1">, internalWidth, internalHeight);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Draw grid lines</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.strokeStyle = </span><span class="s7">'#4B5563'</span><span class="s1">; </span><span class="s11">// gray-600</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.lineWidth = </span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> i = </span><span class="s14">0</span><span class="s1">; i &lt;= </span><span class="s13">GRID_SIZE</span><span class="s1">; i++) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.beginPath();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.moveTo(i * cellSize, </span><span class="s14">0</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.lineTo(i * cellSize, internalHeight);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.stroke();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.beginPath();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.moveTo(</span><span class="s14">0</span><span class="s1">, i * cellSize);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.lineTo(internalWidth, i * cellSize);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.stroke();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Draw constraints (before protein)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (showHints) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>drawConstraints();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Draw protein chain (lines)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.strokeStyle = </span><span class="s7">'#F3F4F6'</span><span class="s1">; </span><span class="s11">// gray-100</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.lineWidth = </span><span class="s14">6</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.beginPath();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> i = </span><span class="s14">0</span><span class="s1">; i &lt; proteinChain.length; i++) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> bead = proteinChain[i];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> x = bead.x * cellSize + cellSize / </span><span class="s14">2</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> y = bead.y * cellSize + cellSize / </span><span class="s14">2</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (i === </span><span class="s14">0</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.moveTo(x, y);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s12">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.lineTo(x, y);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.stroke();</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Draw protein beads (circles)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> i = </span><span class="s14">0</span><span class="s1">; i &lt; proteinChain.length; i++) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> bead = proteinChain[i];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> x = bead.x * cellSize + cellSize / </span><span class="s14">2</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> y = bead.y * cellSize + cellSize / </span><span class="s14">2</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">// pLDDT Ring</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> beadScore = calculateBeadScore(proteinChain, i);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> ringColor = getpLDDTColor(beadScore);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.fillStyle = ringColor;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.beginPath();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.arc(x, y, cellSize * </span><span class="s14">0.45</span><span class="s1">, </span><span class="s14">0</span><span class="s1">, </span><span class="s13">Math</span><span class="s1">.</span><span class="s13">PI</span><span class="s1"> * </span><span class="s14">2</span><span class="s1">); </span><span class="s11">// Outer ring</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.fill();</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">// Main bead</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s13">BEAD_TYPES</span><span class="s1">[bead.type].color;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.beginPath();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.arc(x, y, cellSize * </span><span class="s14">0.38</span><span class="s1">, </span><span class="s14">0</span><span class="s1">, </span><span class="s13">Math</span><span class="s1">.</span><span class="s13">PI</span><span class="s1"> * </span><span class="s14">2</span><span class="s1">); </span><span class="s11">// Inner bead</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.fill();</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Draw bead type text</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s7">'rgba(0,0,0,0.7)'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.font = </span><span class="s7">`bold </span><span class="s1">${cellSize * </span><span class="s14">0.4</span><span class="s1">}</span><span class="s7">px Inter`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.textAlign = </span><span class="s7">'center'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.textBaseline = </span><span class="s7">'middle'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>ctx.fillText(bead.type, x, y);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> drawConstraints() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">const</span><span class="s1"> constraint </span><span class="s12">of</span><span class="s1"> constraints) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (constraint.type === </span><span class="s7">'zone'</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.fillStyle = constraint.color;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.fillRect(</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>constraint.x * cellSize,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>constraint.y * cellSize,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>constraint.w * cellSize,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>constraint.h * cellSize</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (constraint.type === </span><span class="s7">'pair'</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> bead1 = proteinChain[constraint.i1];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> bead2 = proteinChain[constraint.i2];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> x1 = bead1.x * cellSize + cellSize / </span><span class="s14">2</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> y1 = bead1.y * cellSize + cellSize / </span><span class="s14">2</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> x2 = bead2.x * cellSize + cellSize / </span><span class="s14">2</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> y2 = bead2.y * cellSize + cellSize / </span><span class="s14">2</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.strokeStyle = constraint.color;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.lineWidth = </span><span class="s14">5</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.setLineDash([</span><span class="s14">10</span><span class="s1">, </span><span class="s14">5</span><span class="s1">]);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.shadowColor = constraint.color;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.shadowBlur = </span><span class="s14">10</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.beginPath();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.moveTo(x1, y1);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.lineTo(x2, y2);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.stroke();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.setLineDash([]); </span><span class="s11">// Reset line dash</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.shadowBlur = </span><span class="s14">0</span><span class="s1">; </span><span class="s11">// Reset shadow</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Event Handlers ---</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> getEventCoords(e) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> rect = canvas.getBoundingClientRect();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> x, y;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (e.touches) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>x = e.touches[</span><span class="s14">0</span><span class="s1">].clientX - rect.left;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>y = e.touches[</span><span class="s14">0</span><span class="s1">].clientY - rect.top;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s12">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>x = e.clientX - rect.left;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>y = e.clientY - rect.top;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// De-scale from display size to internal size</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> internalX = x * (canvas.width / (window.devicePixelRatio || </span><span class="s14">1</span><span class="s1">) / rect.width);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> internalY = y * (canvas.height / (window.devicePixelRatio || </span><span class="s14">1</span><span class="s1">) / rect.height);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> gx = </span><span class="s13">Math</span><span class="s1">.floor(internalX / cellSize);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> gy = </span><span class="s13">Math</span><span class="s1">.floor(internalY / cellSize);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> { gx, gy };</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> onDown(e) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> { gx, gy } = getEventCoords(e);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Check if we clicked a bead (backwards to drag top bead)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> i = proteinChain.length - </span><span class="s14">1</span><span class="s1">; i &gt; </span><span class="s14">0</span><span class="s1">; i--) { </span><span class="s11">// i &gt; 0, can't drag anchor</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> bead = proteinChain[i];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (bead.x === gx &amp;&amp; bead.y === gy) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>isDragging = </span><span class="s12">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>draggedBeadIndex = i;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Save state for undo AND for chain physics check</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>previousState = lastValidChain.map(bead =&gt; ({ ...bead }));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>lastValidChain = proteinChain.map(bead =&gt; ({ ...bead }));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">break</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> onUp(e) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (isDragging) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>isDragging = </span><span class="s12">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>draggedBeadIndex = -</span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// --- NEW CHAIN PHYSICS CHECK ---</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Check if the chain is still contiguous</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> chainBroken = </span><span class="s12">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">for</span><span class="s1"> (</span><span class="s12">let</span><span class="s1"> i = </span><span class="s14">1</span><span class="s1">; i &lt; proteinChain.length; i++) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> (manhattanDistance(proteinChain[i], proteinChain[i-</span><span class="s14">1</span><span class="s1">]) !== </span><span class="s14">1</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>chainBroken = </span><span class="s12">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">break</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> (chainBroken) {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Revert to the last valid chain state</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>proteinChain = lastValidChain.map(bead =&gt; ({ ...bead }));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s12">else</span><span class="s1"> {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// This is a valid move, update the last valid state</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>lastValidChain = proteinChain.map(bead =&gt; ({ ...bead }));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Final score calculation and draw</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>calculateScore();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> onMove(e) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (!isDragging) </span><span class="s12">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> { gx, gy } = getEventCoords(e);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> i = draggedBeadIndex;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> currentBead = proteinChain[i];</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 1. Check if new position is same as old</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (gx === currentBead.x &amp;&amp; gy === currentBead.y) </span><span class="s12">return</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 2. Check if new position is valid (on grid)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (gx &lt; </span><span class="s14">0</span><span class="s1"> || gx &gt;= </span><span class="s13">GRID_SIZE</span><span class="s1"> || gy &lt; </span><span class="s14">0</span><span class="s1"> || gy &gt;= </span><span class="s13">GRID_SIZE</span><span class="s1">) </span><span class="s12">return</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 3. Check if new position is occupied by another bead</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> isOccupied = proteinChain.some((bead, index) =&gt; {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Check if any *other* bead is in the target square</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s1"> index !== i &amp;&amp; bead.x === gx &amp;&amp; bead.y === gy;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> (isOccupied) </span><span class="s12">return</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// --- Valid Move: Just move the single bead ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>proteinChain[i].x = gx;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>proteinChain[i].y = gy;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Re-draw but DON'T calculate score yet (too slow)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>drawGame();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Initialization ---</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> resizeCanvas() {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Make canvas sharp on all displays</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> dpr = window.devicePixelRatio || </span><span class="s14">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> rect = gridContainer.getBoundingClientRect();</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Set canvas *style* size</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.style.width = </span><span class="s7">`</span><span class="s1">${rect.width}</span><span class="s7">px`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.style.height = </span><span class="s7">`</span><span class="s1">${rect.height}</span><span class="s7">px`</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Set canvas *internal* size</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.width = rect.width * dpr;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.height = rect.height * dpr;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx.scale(dpr, dpr);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>cellSize = rect.width / </span><span class="s13">GRID_SIZE</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Redraw game after resize</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>drawGame();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> init() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas = document.getElementById(</span><span class="s7">'game-canvas'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>ctx = canvas.getContext(</span><span class="s7">'2d'</span><span class="s1">);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Attach event listeners</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.addEventListener(</span><span class="s7">'mousedown'</span><span class="s1">, onDown);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.addEventListener(</span><span class="s7">'mouseup'</span><span class="s1">, onUp);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.addEventListener(</span><span class="s7">'mouseleave'</span><span class="s1">, onUp); </span><span class="s11">// Stop dragging if mouse leaves</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.addEventListener(</span><span class="s7">'mousemove'</span><span class="s1">, onMove);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.addEventListener(</span><span class="s7">'touchstart'</span><span class="s1">, onDown, { passive: </span><span class="s12">false</span><span class="s1"> });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.addEventListener(</span><span class="s7">'touchend'</span><span class="s1">, onUp, { passive: </span><span class="s12">false</span><span class="s1"> });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.addEventListener(</span><span class="s7">'touchcancel'</span><span class="s1">, onUp, { passive: </span><span class="s12">false</span><span class="s1"> });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>canvas.addEventListener(</span><span class="s7">'touchmove'</span><span class="s1">, onMove, { passive: </span><span class="s12">false</span><span class="s1"> });</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>resetButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, () =&gt; setupLevel(currentLevel));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>modalNextButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, () =&gt; setupLevel(currentLevel + </span><span class="s14">1</span><span class="s1">));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>modalCloseButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, () =&gt; setupLevel(</span><span class="s14">1</span><span class="s1">));</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>hintButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, showHint);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>hintCloseButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, () =&gt; hintModal.classList.add(</span><span class="s7">'hidden'</span><span class="s1">));</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>solutionButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, showSolution);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>undoButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, undoMove);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>toggleHintsButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, toggleHints);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>explainScoreButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, showExplainScore);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>explainCloseButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, () =&gt; explainModal.classList.add(</span><span class="s7">'hidden'</span><span class="s1">));</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>window.addEventListener(</span><span class="s7">'resize'</span><span class="s1">, resizeCanvas);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>setupLevel(</span><span class="s14">1</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>resizeCanvas(); </span><span class="s11">// Initial size calculation</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Wait for the DOM to be fully loaded</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>document.addEventListener(</span><span class="s7">'DOMContentLoaded'</span><span class="s1">, init);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p7"><span class="s10"></span><br></p>
</body>
</html>
 
